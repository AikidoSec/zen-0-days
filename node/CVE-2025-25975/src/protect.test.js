const { test } = require("node:test");
const { equal, throws } = require("node:assert");

test("Vulnerable to Prototype Pollution", async () => {
  const parseGitConfig = require("parse-git-config");
  require("@aikidosec/firewall/nopp");

  equal({}.isPolluted, undefined);

  let config = {
    '__proto__ "isPolluted"': true,
  };
  throws(
    () => {
      parseGitConfig.expandKeys(config);
    },
    {
      message: "Cannot add property isPolluted, object is not extensible",
    }
  );
});
